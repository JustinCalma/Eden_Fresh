title Logging Failure Scenario: Inaccurate Save

participant "mainControl : Control" as control
participant "logWriter : LogWriter" as writer
participant "dataAccess : SQLDataAccess" as dao
participant "SQL Server" as db

note over db:The data store is online, accessible to the system,\nand has storage capacity for a log entry.\nUser can call an UPDATE statement\nover the table containing the entry being inserted.
#instantiation/constructors
activate control
control->*dao:new SQLDataAccess()
activate dao
dao->dao:Constructor
dao-->control:SQLDataAccess instance
deactivate dao
control->*writer:new LogWriter(dataAccess : DataAccess)
activate writer
writer->writer:Constructor
writer-->control:LogWriter instance
deactivate writer
#functionality method calls
control->>writer: logWriter.write(userID : int, logLevel : enum, category : enum, message : String)
activate writer
note over writer: System-initiated logs have a userID 0.\nUser-initiated logs have a userID equal to the initiating user's ID.
writer->dao:dataAccess.writeTabulatedValues(tableName : String, keysAndValues : Map<String, String>)
activate dao
#inbound request to show that the log writing is asynchronous
[->control:request
#SQL statement detailed enough? too detailed?
dao->db:INSERT INTO tablename VALUES (userID, timedate, level, category, message)\n    OUTPUT INSERTED.*
activate db
control-->[:response
db-->dao:Inserted row
note over dao:Row's attributes do not match the attributes\npassed from writeTabulateValues() arguments.
deactivate db
dao-->writer: 0 : int
deactivate dao
writer-->>control: false : boolean
deactivate writer
deactivate control
